{
    "name": "jupiterone-integration-failures",
    "description": "Integrations have failed to run or are in a hung state.",
    "queries": [
      {
        "name": "query0",
        "query": "find jupiterone_integration with ((status='IN_PROGRESS' and _beginOn < date.now - 2 day) OR status = 'FAILED') AND pollingInterval!='DISABLED'",
        "version": "v1"
      }
    ],
    "alertLevel": "INFO",
    "templates": {
      "emailBody": "({{itemIndex+1}} of {{itemCount}}) <br><b>{{item.displayName}}</b><br>---<br><b>Integration:</b>{{item.integrationType}}<br><b>InstanceId:</b> {{item.id}}<br><b>Status:</b> {{item.status}}<br><b>PollingInterval:</b> {{item.pollingInterval}}<br><b>URL:</b> https://apps.us.jupiterone.io/integrations/{{item.integrationType}}/{{item.id}}/jobs<br><br>",
      "slackBody": "({{itemIndex+1}} of {{itemCount}}) \n*{{item.displayName}}*\n---\n*Integration:* {{item.integrationType}}\n*InstanceId:* {{item.id}}\n*Status:* {{item.status}}\n *PollingInterval:* {{item.pollingInterval}}\n *URL:* https://apps.us.jupiterone.io/integrations/{{item.integrationType}}/{{item.id}}/jobs \n\n"
    }
}
