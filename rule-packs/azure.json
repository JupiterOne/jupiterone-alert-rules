[
    {
      "name": "azure-asc-monitor-system-updates",
      "description": "Finds if Azure Security Center setting 'Monitor System Updates' is disabled.",
      "queries": [
        {
          "name": "query0",
          "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.systemUpdatesMonitoringEffect=\"Disabled\"",
          "version": "v1"
        }
      ]
    },
    {
      "name": "azure-asc-monitor-os-vulnerabilities",
      "description": "Finds if Azure Security Center setting 'Monitor OS Vulnerabilities' is disabled.",
      "queries": [
        {
          "name": "query0",
          "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.systemConfigurationsMonitoringEffect=\"Disabled\"",
          "version": "v1"
        }
      ]
    },
    {
        "name": "azure-asc-monitor-endpoint-protection",
        "description": "Finds if Azure Security Center setting 'Monitor Endpoint Protection' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.endpointProtectionMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-disk-encryption",
        "description": "Finds if Azure Security Center setting 'Monitor Disk Encryption' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.diskEncryptionMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-network-security-groups",
        "description": "Finds if Azure Security Center setting 'Monitor Network Security Groups' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.networkSecurityGroupsMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-web-application-firewall",
        "description": "Finds if Azure Security Center setting 'Monitor Web Application Firewall' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.webApplicationFirewallMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-next-generation-firewall",
        "description": "Finds if Azure Security Center setting 'Monitor Enable Next Generation Firewall (NGFW)' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.nextGenerationFirewallMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-vulnerability-assessment",
        "description": "Finds if Azure Security Center setting 'Monitor Vulnerability Assessment' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.vulnerabilityAssesmentMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-storage-blob-encryption",
        "description": "Finds if Azure Security Center setting 'Monitor Storage Blob Encryption' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.storageEncryptionMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-JIT-network-access",
        "description": "Finds if Azure Security Center setting 'Monitor JIT Network Access' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.jitNetworkAccessMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-adaptive-application-whitelisting",
        "description": "Finds if Azure Security Center setting 'Monitor Adaptive Application Whitelisting' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.adaptiveApplicationControlsMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-sql-auditing",
        "description": "Finds if Azure Security Center setting 'Monitor SQL Auditing' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.sqlAuditingMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-asc-monitor-sql-encryption",
        "description": "Finds if Azure Security Center setting 'Monitor SQL Encryption' is disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_policy_assignment with id $=\"/SecurityCenterBuiltIn\" and params.sqlEncryptionMonitoringEffect=\"Disabled\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-security-contact-email",
        "description": "Finds if there is no security contact email address set.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_security_center_contact with name=\"default1\" and email=undefined",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-security-contact-phone-number",
        "description": "Finds if there is no security contact phone number set.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_security_center_contact with name=\"default1\" and phone=undefined",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-high-sev-alert-email-notification",
        "description": "Finds if email notifications are disabled for high severity alerts.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_security_center_contact with name=\"default1\" and alertNotifications!=\"On\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-admin-email-notification",
        "description": "Finds if email notifications to subscription owners are disabled.",
        "queries": [
          {
            "name": "query0",
            "query": "find azure_security_center_contact with name=\"default1\" and alertsToAdmins!=\"On\"",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-public-blob-storage-container",
        "description": "Finds if Azure Blob Storage Containers have public access enabled.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_storage_container with public=true or publicAccess!='None'",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-auditing",
        "description": "Finds if Azure SQL servers/databases don't have auditing enabled.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_sql_server with auditingEnabled!=true\n  that has azure_sql_database with auditingEnabled!=true",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-audit-actions-groups",
        "description": "Finds if Azure SQL servers/databases don't have audit actions/groups defined.",
        "queries": [
          {
            "name": "query0",
            "query": "Find (azure_sql_server|azure_sql_database) with auditActionsAndGroups=undefined",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-retention",
        "description": "Finds if Azure SQL servers/databases don't minimum retention duration of 90 days.",
        "queries": [
          {
            "name": "query0",
            "query": "Find (azure_sql_server|azure_sql_database) with\n  auditLogRetentionDays < 90 or auditLogRetentionDays = undefined",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-advanced-data-security",
        "description": "Finds if Azure SQL servers don't have Advanced Data Security enabled.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_sql_server with alertingEnabled != true",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-advanced-data-security-threats",
        "description": "Finds if Azure SQL servers don't have all Advanced Data Security (alerting) rules enabled.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_sql_server with alertOnAllThreats != true as server\nReturn server.name, server.alertingEnabled, server.alertsDisabled, server.webLink",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-advanced-data-security-notifications",
        "description": "Finds if Azure SQL servers with Advanced Data Security don't have alert recipient email addresses defined.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_sql_server with alertEmails = undefined",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-advanced-data-security-notifications-admin",
        "description": "Finds if Azure SQL servers with Advanced Data Security don't have admin alerts enabled.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_sql_server with alertAdmins != true",
            "version": "v1"
          }
        ]
    }, 
    {
        "name": "azure-sql-encryption-rest",
        "description": "Finds if Azure SQL servers aren't encrypted at rest.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_sql_server with encrypted!=true",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-mysql-encryption-transit",
        "description": "Finds if Azure MySQL servers aren't encrypted in transit.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_mysql_server with sslEnforced!=true and sslEnforcement!='Enabled'",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-sql-postgres-encryption-transit",
        "description": "Finds if Azure PostgreSQL servers aren't encrypted in transit.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_postgresql_server with sslEnforced!=true and sslEnforcement!='Enabled'",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-access-internet",
        "description": "Finds if Azure Security Group rules allow access to resources via the Internet.",
        "queries": [
          {
            "name": "query0",
            "query": "find Internet that allows as rule azure_security_group\n  that protects * that (has|contains|connects|uses) *\nreturn tree",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-access-internet-nonweb",
        "description": "Finds if Azure Security Group rules allowing access to resources via the Internet through non-web access (outside of TCP ports 80/443).",
        "queries": [
          {
            "name": "query0",
            "query": "find Internet that allows as rule azure_security_group as sg\n  that protects * as i\n  that (has|contains|connects|uses) (Host|Gateway) as h\nwhere\n  rule.ingress=true and\n  (rule.fromPort!=80 and rule.toPort!=80) and\n  (rule.toPort!=443 and rule.toPort!=443)\nreturn\n  sg.displayName, sg.resourceGroup,\n  rule.protocol, rule.fromPort, rule.toPort,\n  i._type, i.displayName, i.CIDR, i.privateIp, i.publicIp,\n  h._type, h.displayName, h.webLink",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-access-rdp",
        "description": "Finds if Azure Security Group rules allow RDP (port 3389) access from the Internet.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_security_group that allows as rule Internet\nwhere rule.inbound=true and rule.fromPort <= 3389 and rule.toPort >= 3389",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-access-ssh",
        "description": "Finds if Azure Security Group rules allow SSH (TCP port 22) access from the Internet.",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_security_group that allows as rule Internet\nwhere rule.inbound=true and rule.fromPort <= 22 and rule.toPort >= 22",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-managed-disk-encryption-boot",
        "description": "Finds if there are Azure managed disks with an installed OS, attached to a host, without encryption enabled. ",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_managed_disk with osType!=undefined and attached=true and encrypted!=true",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-managed-disk-encryption",
        "description": "Finds if there are Azure managed disks without an installed OS, attached to a host, without encryption enabled. ",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_managed_disk with osType=undefined and attached=true and encrypted!=true",
            "version": "v1"
          }
        ]
    },
    {
        "name": "azure-managed-disk-encryption-unattached",
        "description": "Finds if there are Azure unattached managed disks without encryption enabled. ",
        "queries": [
          {
            "name": "query0",
            "query": "Find azure_managed_disk with attached=false and encrypted!=true",
            "version": "v1"
          }
        ]
    }
  ]
  asdfasdf