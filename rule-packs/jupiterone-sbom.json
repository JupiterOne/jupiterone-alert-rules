[
    {
        "name": "sbom-code-repos-with-vulnerable-module",
        "description": "Finds code repos that use a known vulnerable version of a module.",
        "queries": [
          {
            "name": "query0",
            "query": "FIND CodeModule THAT RELATES TO << CodeRepo THAT HAS Finding WITH numericSeverity >= 7",
            "version": "v1"
          }
        ],
        "alertLevel": "MEDIUM"
    },
    {
        "name": "sbom-workloads-with-vulnerable-module",
        "description": "Finds deployed workloads using known vulnerable versions of a module.",
        "queries": [
          {
            "name": "query0",
            "query": "FIND (Worlkoad|Function|Host) THAT DEFINES << CodeRepo THAT HAS Finding WITH numericSeverity >= 7 (THAT RELATES TO CodeModule)?",
            "version": "v1"
          }
        ],
        "alertLevel": "MEDIUM"
    },
    {
        "name": "sbom-all-module-versions-used",
        "description": "Finds all versions of a module used by your application.",
        "queries": [
          {
            "name": "query0",
            "query": "FIND (CodeRepo|CodeModule) AS parent THAT CONTAINS AS rel CodeModule RETURN parent.displayName, rel.version",
            "version": "v1"
          }
        ],
        "alertLevel": "INFO"
    },
    {
        "name": "sbom-nested-sboms",
        "description": "See the nested nature of SBOMs and why graph databases are a good way to consume them.",
        "queries": [
          {
            "name": "query0",
            "query": "FIND CodeRepo THAT CONTAINS >> CodeModule THAT CONTAINS >> CodeModule THAT CONTAINS >> CodeModule THAT CONTAINS >> CodeModule THAT CONTAINS >> CodeModule THAT CONTAINS >> CodeModule THAT CONTAINS >> CodeModule THAT CONTAINS >> CodeModule RETURN TREE",
            "version": "v1"
          }
        ],
        "alertLevel": "INFO"
    },
    {
        "name": "sbom-most-used-packages",
        "description": "Find your most used packages.",
        "queries": [
          {
            "name": "query0",
            "query": "FIND (CodeRepo|CodeModule) AS src THAT CONTAINS >> AS rel CodeModule AS target RETURN target.displayName, rel.version, COUNT(src) AS cnt ORDER BY cnt DESC",
            "version": "v1"
          }
        ],
        "alertLevel": "INFO"
    },
    {
      "name": "sbom-merged-pull-requests-with-critical-findings",
      "description": "Look for pull requests with critical findings",
      "queries": [
        {
          "name": "query0",
          "query": "FIND Finding AS finding THAT HAS << CodeRepo AS repo THAT RELATES TO PR WITH merged = true AS pullRequest RETURN repo.displayName, finding.displayName, pullRequest.displayName",
          "version": "v1"
        }
      ],
      "alertLevel": "HIGH"
  },
  {
    "name": "sbom-repositories-with-active-findings",
    "description": "Find repositories with active findings.",
    "queries": [
      {
        "name": "query0",
        "query": "FIND Finding WITH open = true AS finding THAT HAS << CodeRepo AS repo RETURN repo.displayName as repository, count(finding) AS findingCount ORDER BY findingCount DESC",
        "version": "v1"
      }
    ],
    "alertLevel": "INFO"
  },
  {
    "name": "sbom-package-dependencies-flows",
    "description": "Find packages and their dependency names.",
    "queries": [
      {
        "name": "query0",
        "query": "FIND UNIQUE CodeModule THAT RELATES TO as dependency CodeRepo RETURN dependency.displayName as dependencyName",
        "version": "v1"
      }
    ],
    "alertLevel": "INFO"
  },
  {
    "name": "sbom-package-dependencies",
    "description": "Find packages and their dependencies.",
    "queries": [
      {
        "name": "query0",
        "query": "FIND UNIQUE CodeModule THAT RELATES TO as dependency CodeRepo",
        "version": "v1"
      }
    ],
    "alertLevel": "INFO"
  }
]